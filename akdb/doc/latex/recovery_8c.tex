\hypertarget{recovery_8c}{}\section{rec/recovery.c File Reference}
\label{recovery_8c}\index{rec/recovery.\+c@{rec/recovery.\+c}}
{\ttfamily \#include \char`\"{}recovery.\+h\char`\"{}}\newline
Include dependency graph for recovery.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recovery_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{recovery_8c_a0764228149712593c8af8241538a3ff7}{A\+K\+\_\+recover\+\_\+archive\+\_\+log} (char $\ast$file\+Name)
\begin{DoxyCompactList}\small\item\em Reads binary file where last commands were saved, and executes them. \end{DoxyCompactList}\item 
void \hyperlink{recovery_8c_a007675f089d3aadc7e1dec6a5421bfd4}{A\+K\+\_\+recovery\+\_\+insert\+\_\+row} (char $\ast$table, char $\ast$$\ast$attributes)
\begin{DoxyCompactList}\small\item\em Inserts a new row in table with attributes. \end{DoxyCompactList}\item 
char $\ast$$\ast$ \hyperlink{recovery_8c_a94c27377e1fb404252b803979db877bc}{A\+K\+\_\+recovery\+\_\+tokenize} (char $\ast$input, char $\ast$delimiter, int values\+Or\+Not)
\begin{DoxyCompactList}\small\item\em Tokenizes the input with the given delimiter and puts them in an double pointer structure (so we can execute an insert) \end{DoxyCompactList}\item 
void \hyperlink{recovery_8c_aaab30d878f086d3f949315e7a84c6b4f}{A\+K\+\_\+recover\+\_\+operation} (int sig)
\begin{DoxyCompactList}\small\item\em Function that recovers and executes failed commands. \end{DoxyCompactList}\item 
void \hyperlink{recovery_8c_a8edc2b153314177eb5ab3d3851d8ea22}{A\+K\+\_\+recovery\+\_\+test} ()
\begin{DoxyCompactList}\small\item\em Function for recovery testing. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
short \hyperlink{recovery_8c_ae9a3d74aeca021c84cae55b9ff943378}{grandfailure} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Provides recovery functions. 

\subsection{Function Documentation}
\mbox{\Hypertarget{recovery_8c_a0764228149712593c8af8241538a3ff7}\label{recovery_8c_a0764228149712593c8af8241538a3ff7}} 
\index{recovery.\+c@{recovery.\+c}!A\+K\+\_\+recover\+\_\+archive\+\_\+log@{A\+K\+\_\+recover\+\_\+archive\+\_\+log}}
\index{A\+K\+\_\+recover\+\_\+archive\+\_\+log@{A\+K\+\_\+recover\+\_\+archive\+\_\+log}!recovery.\+c@{recovery.\+c}}
\subsubsection{\texorpdfstring{A\+K\+\_\+recover\+\_\+archive\+\_\+log()}{AK\_recover\_archive\_log()}}
{\footnotesize\ttfamily void A\+K\+\_\+recover\+\_\+archive\+\_\+log (\begin{DoxyParamCaption}\item[{char $\ast$}]{file\+Name }\end{DoxyParamCaption})}



Reads binary file where last commands were saved, and executes them. 

Function opens the recovery binary file and executes all commands that were saved inside the redo\+\_\+log structure \begin{DoxyAuthor}{Author}
Dražen Bandić, update by Tomislav Turek 
\end{DoxyAuthor}

\begin{DoxyParams}{Parameters}
{\em file\+Name} & -\/ name of the archive log \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
no value 
\end{DoxyReturn}
\mbox{\Hypertarget{recovery_8c_aaab30d878f086d3f949315e7a84c6b4f}\label{recovery_8c_aaab30d878f086d3f949315e7a84c6b4f}} 
\index{recovery.\+c@{recovery.\+c}!A\+K\+\_\+recover\+\_\+operation@{A\+K\+\_\+recover\+\_\+operation}}
\index{A\+K\+\_\+recover\+\_\+operation@{A\+K\+\_\+recover\+\_\+operation}!recovery.\+c@{recovery.\+c}}
\subsubsection{\texorpdfstring{A\+K\+\_\+recover\+\_\+operation()}{AK\_recover\_operation()}}
{\footnotesize\ttfamily void A\+K\+\_\+recover\+\_\+operation (\begin{DoxyParamCaption}\item[{int}]{sig }\end{DoxyParamCaption})}



Function that recovers and executes failed commands. 

Function is called when S\+I\+G\+I\+NT signal is sent to the system. All commands that are written to rec.\+bin file are recovered to the designated structure and then executed. \begin{DoxyAuthor}{Author}
Tomislav Turek 
\end{DoxyAuthor}

\begin{DoxyParams}{Parameters}
{\em sig} & required integer parameter for S\+I\+G\+I\+NT handler functions \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{recovery_8c_a007675f089d3aadc7e1dec6a5421bfd4}\label{recovery_8c_a007675f089d3aadc7e1dec6a5421bfd4}} 
\index{recovery.\+c@{recovery.\+c}!A\+K\+\_\+recovery\+\_\+insert\+\_\+row@{A\+K\+\_\+recovery\+\_\+insert\+\_\+row}}
\index{A\+K\+\_\+recovery\+\_\+insert\+\_\+row@{A\+K\+\_\+recovery\+\_\+insert\+\_\+row}!recovery.\+c@{recovery.\+c}}
\subsubsection{\texorpdfstring{A\+K\+\_\+recovery\+\_\+insert\+\_\+row()}{AK\_recovery\_insert\_row()}}
{\footnotesize\ttfamily void A\+K\+\_\+recovery\+\_\+insert\+\_\+row (\begin{DoxyParamCaption}\item[{char $\ast$}]{table,  }\item[{char $\ast$$\ast$}]{attributes }\end{DoxyParamCaption})}



Inserts a new row in table with attributes. 

Function is given the table name with desired data that should be inserted inside. By using the table name, function retrieves table attributes names and their types which uses afterwards for insert\+\_\+data\+\_\+test function to insert data to designated table. \begin{DoxyAuthor}{Author}
Dražen Bandić, updated by Tomislav Turek 
\end{DoxyAuthor}

\begin{DoxyParams}{Parameters}
{\em table} & -\/ table name to insert to \\
\hline
{\em attributes} & -\/ attribute to insert \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
no value 
\end{DoxyReturn}
\mbox{\Hypertarget{recovery_8c_a8edc2b153314177eb5ab3d3851d8ea22}\label{recovery_8c_a8edc2b153314177eb5ab3d3851d8ea22}} 
\index{recovery.\+c@{recovery.\+c}!A\+K\+\_\+recovery\+\_\+test@{A\+K\+\_\+recovery\+\_\+test}}
\index{A\+K\+\_\+recovery\+\_\+test@{A\+K\+\_\+recovery\+\_\+test}!recovery.\+c@{recovery.\+c}}
\subsubsection{\texorpdfstring{A\+K\+\_\+recovery\+\_\+test()}{AK\_recovery\_test()}}
{\footnotesize\ttfamily void A\+K\+\_\+recovery\+\_\+test (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Function for recovery testing. 

Function does nothing while waiting a S\+I\+G\+I\+NT signal (signal represents // doxygen @ for full description ??? system failure). Upon retrieving the signal it calls function A\+K\+\_\+recover\+\_\+operation which starts the recovery by building commands. To comply with the designated structure \hyperlink{structAK__command__recovery__struct}{A\+K\+\_\+command\+\_\+recovery\+\_\+struct} // \{link\} to struct ??? it writes dummy commands to the file log.\+log \begin{DoxyAuthor}{Author}
Tomislav Turek 
\end{DoxyAuthor}
\mbox{\Hypertarget{recovery_8c_a94c27377e1fb404252b803979db877bc}\label{recovery_8c_a94c27377e1fb404252b803979db877bc}} 
\index{recovery.\+c@{recovery.\+c}!A\+K\+\_\+recovery\+\_\+tokenize@{A\+K\+\_\+recovery\+\_\+tokenize}}
\index{A\+K\+\_\+recovery\+\_\+tokenize@{A\+K\+\_\+recovery\+\_\+tokenize}!recovery.\+c@{recovery.\+c}}
\subsubsection{\texorpdfstring{A\+K\+\_\+recovery\+\_\+tokenize()}{AK\_recovery\_tokenize()}}
{\footnotesize\ttfamily char$\ast$$\ast$ A\+K\+\_\+recovery\+\_\+tokenize (\begin{DoxyParamCaption}\item[{char $\ast$}]{input,  }\item[{char $\ast$}]{delimiter,  }\item[{int}]{values\+Or\+Not }\end{DoxyParamCaption})}



Tokenizes the input with the given delimiter and puts them in an double pointer structure (so we can execute an insert) 

\begin{DoxyAuthor}{Author}
Dražen Bandić 
\end{DoxyAuthor}

\begin{DoxyParams}{Parameters}
{\em input} & -\/ input to tokenize \\
\hline
{\em delimiter} & -\/ delimiter \\
\hline
{\em values\+Or\+Not} & -\/ 1 if the input are values, 0 otherwise \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
new double pointer structure with tokens 
\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{recovery_8c_ae9a3d74aeca021c84cae55b9ff943378}\label{recovery_8c_ae9a3d74aeca021c84cae55b9ff943378}} 
\index{recovery.\+c@{recovery.\+c}!grandfailure@{grandfailure}}
\index{grandfailure@{grandfailure}!recovery.\+c@{recovery.\+c}}
\subsubsection{\texorpdfstring{grandfailure}{grandfailure}}
{\footnotesize\ttfamily short grandfailure = 0}

this variable flags if system failed 