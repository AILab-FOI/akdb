
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_47c25c331c075fe16f320299349474de.html">rec</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">recovery.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;recovery.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for recovery.c:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_8c__incl.png" border="0" usemap="#rec_2recovery_8c" alt=""/></div>
<map name="rec_2recovery_8c" id="rec_2recovery_8c">
<area shape="rect" id="node2" href="recovery_8h_source.html" title="recovery.h" alt="" coords="1427,80,1517,107"/>
<area shape="rect" id="node3" href="auxiliary_8h.html" title="../auxi/auxiliary.h" alt="" coords="1322,603,1457,629"/>
<area shape="rect" id="node4" href="constants_8h.html" title="constants.h" alt="" coords="1570,677,1667,704"/>
<area shape="rect" id="node5" href="configuration_8h_source.html" title="configuration.h" alt="" coords="1692,677,1812,704"/>
<area shape="rect" id="node13" href="mempro_8h.html" title="mempro.h" alt="" coords="970,901,1059,928"/>
<area shape="rect" id="node19" href="debug_8h.html" title="debug.h" alt="" coords="1364,827,1439,853"/>
<area shape="rect" id="node20" href="memoman_8h.html" title="../mm/memoman.h" alt="" coords="437,453,584,480"/>
<area shape="rect" id="node28" href="archive__log_8h.html" title="../rec/archive_log.h" alt="" coords="993,304,1138,331"/>
<area shape="rect" id="node29" href="table_8h.html" title="../file/table.h" alt="" coords="344,379,448,405"/>
<area shape="rect" id="node30" href="fileio_8h.html" title="../file/fileio.h" alt="" coords="848,155,952,181"/>
<area shape="rect" id="node35" href="test_8h.html" title="../file/test.h" alt="" coords="301,155,397,181"/>
<area shape="rect" id="node36" href="rel__eq__selection_8h.html" title="../opti/rel_eq_selection.h" alt="" coords="93,304,275,331"/>
<area shape="rect" id="node6" href="iniparser_8h.html" title="Parser for ini files. " alt="" coords="1679,752,1769,779"/>
<area shape="rect" id="node11" href="dictionary_8h.html" title="Implements a dictionary for string variables. " alt="" coords="1675,827,1773,853"/>
<area shape="rect" id="node21" href="dbman_8h.html" title="../dm/dbman.h" alt="" coords="787,528,903,555"/>
<area shape="rect" id="node31" href="reference_8h.html" title="../sql/cs/reference.h" alt="" coords="725,304,875,331"/>
<area shape="rect" id="node32" href="redo__log_8h_source.html" title="../rec/redo_log.h" alt="" coords="1305,229,1431,256"/>
<area shape="rect" id="node33" href="files_8h.html" title="files.h" alt="" coords="326,229,389,256"/>
<area shape="rect" id="node34" href="id_8h.html" title="id.h" alt="" coords="350,304,397,331"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0764228149712593c8af8241538a3ff7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recovery_8c.html#a0764228149712593c8af8241538a3ff7">AK_recover_archive_log</a> (char *fileName)</td></tr>
<tr class="memdesc:a0764228149712593c8af8241538a3ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads binary file where last commands were saved, and executes them.  <a href="#a0764228149712593c8af8241538a3ff7">More...</a><br /></td></tr>
<tr class="separator:a0764228149712593c8af8241538a3ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007675f089d3aadc7e1dec6a5421bfd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recovery_8c.html#a007675f089d3aadc7e1dec6a5421bfd4">AK_recovery_insert_row</a> (char *table, char **attributes)</td></tr>
<tr class="memdesc:a007675f089d3aadc7e1dec6a5421bfd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a new row in table with attributes.  <a href="#a007675f089d3aadc7e1dec6a5421bfd4">More...</a><br /></td></tr>
<tr class="separator:a007675f089d3aadc7e1dec6a5421bfd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94c27377e1fb404252b803979db877bc"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recovery_8c.html#a94c27377e1fb404252b803979db877bc">AK_recovery_tokenize</a> (char *input, char *delimiter, int valuesOrNot)</td></tr>
<tr class="memdesc:a94c27377e1fb404252b803979db877bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tokenizes the input with the given delimiter and puts them in an double pointer structure (so we can execute an insert)  <a href="#a94c27377e1fb404252b803979db877bc">More...</a><br /></td></tr>
<tr class="separator:a94c27377e1fb404252b803979db877bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab30d878f086d3f949315e7a84c6b4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recovery_8c.html#aaab30d878f086d3f949315e7a84c6b4f">AK_recover_operation</a> (int sig)</td></tr>
<tr class="memdesc:aaab30d878f086d3f949315e7a84c6b4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that recovers and executes failed commands.  <a href="#aaab30d878f086d3f949315e7a84c6b4f">More...</a><br /></td></tr>
<tr class="separator:aaab30d878f086d3f949315e7a84c6b4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8edc2b153314177eb5ab3d3851d8ea22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recovery_8c.html#a8edc2b153314177eb5ab3d3851d8ea22">AK_recovery_test</a> ()</td></tr>
<tr class="memdesc:a8edc2b153314177eb5ab3d3851d8ea22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for recovery testing.  <a href="#a8edc2b153314177eb5ab3d3851d8ea22">More...</a><br /></td></tr>
<tr class="separator:a8edc2b153314177eb5ab3d3851d8ea22"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae9a3d74aeca021c84cae55b9ff943378"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recovery_8c.html#ae9a3d74aeca021c84cae55b9ff943378">grandfailure</a> = 0</td></tr>
<tr class="separator:ae9a3d74aeca021c84cae55b9ff943378"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides recovery functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0764228149712593c8af8241538a3ff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0764228149712593c8af8241538a3ff7">&#9670;&nbsp;</a></span>AK_recover_archive_log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AK_recover_archive_log </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads binary file where last commands were saved, and executes them. </p>
<p>Function opens the recovery binary file and executes all commands that were saved inside the redo_log structure </p><dl class="section author"><dt>Author</dt><dd>Dražen Bandić, update by Tomislav Turek </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>- name of the archive log </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>no value </dd></dl>

</div>
</div>
<a id="aaab30d878f086d3f949315e7a84c6b4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaab30d878f086d3f949315e7a84c6b4f">&#9670;&nbsp;</a></span>AK_recover_operation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AK_recover_operation </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that recovers and executes failed commands. </p>
<p>Function is called when SIGINT signal is sent to the system. All commands that are written to rec.bin file are recovered to the designated structure and then executed. </p><dl class="section author"><dt>Author</dt><dd>Tomislav Turek </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sig</td><td>required integer parameter for SIGINT handler functions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a007675f089d3aadc7e1dec6a5421bfd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a007675f089d3aadc7e1dec6a5421bfd4">&#9670;&nbsp;</a></span>AK_recovery_insert_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AK_recovery_insert_row </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>attributes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts a new row in table with attributes. </p>
<p>Function is given the table name with desired data that should be inserted inside. By using the table name, function retrieves table attributes names and their types which uses afterwards for insert_data_test function to insert data to designated table. </p><dl class="section author"><dt>Author</dt><dd>Dražen Bandić, updated by Tomislav Turek </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table</td><td>- table name to insert to </td></tr>
    <tr><td class="paramname">attributes</td><td>- attribute to insert </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>no value </dd></dl>

</div>
</div>
<a id="a8edc2b153314177eb5ab3d3851d8ea22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8edc2b153314177eb5ab3d3851d8ea22">&#9670;&nbsp;</a></span>AK_recovery_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AK_recovery_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for recovery testing. </p>
<p>Function does nothing while waiting a SIGINT signal (signal represents // doxygen @ for full description ??? system failure). Upon retrieving the signal it calls function AK_recover_operation which starts the recovery by building commands. To comply with the designated structure <a class="el" href="structAK__command__recovery__struct.html" title="recovery structure used to recover commands from binary file ">AK_command_recovery_struct</a> // {link} to struct ??? it writes dummy commands to the file log.log </p><dl class="section author"><dt>Author</dt><dd>Tomislav Turek </dd></dl>

</div>
</div>
<a id="a94c27377e1fb404252b803979db877bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94c27377e1fb404252b803979db877bc">&#9670;&nbsp;</a></span>AK_recovery_tokenize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char** AK_recovery_tokenize </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>delimiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>valuesOrNot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tokenizes the input with the given delimiter and puts them in an double pointer structure (so we can execute an insert) </p>
<dl class="section author"><dt>Author</dt><dd>Dražen Bandić </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>- input to tokenize </td></tr>
    <tr><td class="paramname">delimiter</td><td>- delimiter </td></tr>
    <tr><td class="paramname">valuesOrNot</td><td>- 1 if the input are values, 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new double pointer structure with tokens </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae9a3d74aeca021c84cae55b9ff943378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9a3d74aeca021c84cae55b9ff943378">&#9670;&nbsp;</a></span>grandfailure</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short grandfailure = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>this variable flags if system failed </p>

</div>
</div>
</div><!-- contents -->

